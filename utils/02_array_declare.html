<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>数组声明式方法</title>
</head>
<body>
  <script>
    /* 
    自定义实现一组数组声明式方法
      1. map()
      2. reduce()
      3. filter()
      4. find()
      5. findIndex()
      6. every()
      7. some()
    */

    /* 1. map() */
    Array.prototype.map = function (callback) {
      const arr = []
      for (let index = 0; index < this.length; index++) {
        arr.push(callback(this[index], index))
      }

      return arr
    }

    const arr = [1, 3, 4, 5, 7, 8]
    var arr2 = arr.map((item, index) => {
      if (index%2===0) {
        return item + 10
      } else {
        return item + 20
      }
    })
    console.log(arr2)

    /* 2. reduce() */
    Array.prototype.reduce = function (callback, initValue) {
      let total = initValue
      for (let index = 0; index < this.length; index++) {
        total = callback(total, this[index], index)
      }
      return total
    }

    var result = arr.reduce((pre, item, index) => {
      if (index%2===1 && item%2===1) {
        pre += item
      }
      return pre
    }, 0)
    console.log(result)
   
    // 3. filter()
    Array.prototype.filter = function (callback) {
      const arr = []
      for (let index = 0; index < this.length; index++) {
        if (callback(this[index], index)) {
          arr.push(this[index])
        }
      }
      return arr
    }

    arr2 = arr.filter((item, index) => index%2===1 && item%2===1)
    console.log(arr2)

    // 4. find()
    Array.prototype.find = function (callback) {
      for (let index = 0; index < this.length; index++) {
        if (callback(this[index], index)) {
          return this[index]
        }
      }
    }
    result = arr.find((item, index) => index%2===1 && item%2===1)
    console.log(result)

    // 5. findIndex()
    Array.prototype.findIndex = function (callback) {
      for (let index = 0; index < this.length; index++) {
        if (callback(this[index], index)) {
          return index
        }
      }
      return -1 // 没有找到
    }
    result = arr.findIndex((item, index) => index%2===1 && item%2===1)
    console.log(result)

    // 6. every()
    Array.prototype.every = function (callback) {
      for (let index = 0; index < this.length; index++) {
        if (!callback(this[index], index)) {
          return false
        }
      }
      return true
    }
    result = arr.every((item, index) => item>3)
    console.log(result)
    // 7. some()
    Array.prototype.some = function (callback) {
      for (let index = 0; index < this.length; index++) {
        if (callback(this[index], index)) {
          return true
        }
      }
      return false
    }
    result = arr.some((item, index) => item>3)
    console.log(result)
  </script>
</body>
</html>